<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì—ìŠ¤ì˜ì–´ì „ë¬¸í•™ì›: ê·¸ë°”ìœ 4 (ìˆœì„œ ë°°ì—´)</title>
    <style>
        :root { --primary-color: #4A90E2; --secondary-bg: #F0F4F8; --text-main: #2D3748; }
        body { font-family: 'Pretendard', sans-serif; background-color: #F7FAFC; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .container { background: white; width: 95%; max-width: 600px; padding: 30px; border-radius: 20px; box-shadow: 0 15px 35px rgba(0,0,0,0.08); text-align: center; }
        .hidden { display: none; }
        
        .guide-box { background: var(--secondary-bg); padding: 12px; border-radius: 8px; font-size: 0.95rem; margin-bottom: 20px; border-left: 4px solid var(--primary-color); }
        input { width: 100%; padding: 12px; margin-bottom: 10px; border: 1px solid #E2E8F0; border-radius: 8px; box-sizing: border-box; }
        
        /* ë¬¸ì¥ ì™„ì„± ì˜ì—­ */
        #sentence-display { min-height: 60px; padding: 15px; border: 2px dashed #CBD5E0; border-radius: 12px; margin-bottom: 20px; display: flex; flex-wrap: wrap; gap: 8px; align-items: center; justify-content: center; background: #fff; }
        
        /* ë‹¨ì–´ ì¹© ìŠ¤íƒ€ì¼ */
        .word-chip { padding: 10px 16px; background: #EDF2F7; border-radius: 25px; cursor: pointer; font-weight: 600; transition: 0.2s; border: 1px solid #E2E8F0; user-select: none; }
        .word-chip:hover { background: #E2E8F0; }
        .word-chip.used { opacity: 0.3; cursor: default; pointer-events: none; }
        .word-chip.in-sentence { background: var(--primary-color); color: white; border: none; }
        
        #chips-container { display: flex; flex-wrap: wrap; gap: 10px; justify-content: center; margin-bottom: 30px; }
        
        button.btn-main { width: 100%; padding: 16px; background: var(--primary-color); color: white; border: none; border-radius: 10px; font-weight: bold; cursor: pointer; margin-top: 10px; }
        button.btn-reset { background: #A0AEC0; margin-top: 5px; }

        .korean-text { font-size: 1.1rem; font-weight: bold; color: #1A365D; margin-bottom: 15px; }
        .progress-bar { width: 100%; height: 6px; background: #EDF2F7; border-radius: 3px; margin-bottom: 20px; }
        #progress-inner { height: 100%; background: var(--primary-color); width: 0%; transition: width 0.3s; }
    </style>
</head>
<body>

<div class="container">
    <div id="setup-page">
        <h2>Toë¶€ì •ì‚¬ ì‹¤ì „ Part 4</h2>
        <div class="guide-box">ìˆœì„œ ë°°ì—´ í…ŒìŠ¤íŠ¸ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤.</div>
        <input type="text" id="school" placeholder="í•™êµëª…">
        <input type="text" id="name" placeholder="ì„±ëª…">
        <button class="btn-main" onclick="prepareQuiz()">ì‹œí—˜ ì‹œì‘í•˜ê¸°</button>
    </div>

    <div id="quiz-page" class="hidden">
        <div class="progress-bar"><div id="progress-inner"></div></div>
        <div class="korean-text" id="korean-display"></div>
        <div class="guide-box">ğŸ’¡ ì•„ë˜ ë‹¨ì–´ë“¤ì„ ìˆœì„œëŒ€ë¡œ í´ë¦­í•˜ì—¬ ë¬¸ì¥ì„ ì™„ì„±í•˜ì„¸ìš”.</div>
        
        <div id="sentence-display"></div>
        <div id="chips-container"></div>
        
        <button class="btn-main" id="submit-btn" onclick="submitAnswer()">ì •ë‹µ í™•ì¸</button>
        <button class="btn-main btn-reset" onclick="resetSentence()">ì§€ìš°ê¸°</button>
    </div>

    <div id="result-page" class="hidden">
        <h2>í…ŒìŠ¤íŠ¸ ì™„ë£Œ</h2>
        <h1 id="res-score" style="color:var(--primary-color);">0 / 10</h1>
        <div id="wrong-list" style="text-align:left; font-size: 0.9rem; margin-top:20px;"></div>
        <button class="btn-main" onclick="location.reload()">ìƒˆ ë¬¸ì œ í’€ê¸°</button>
    </div>
</div>

<script>
    const allData = [
        { "korean": "ê·¸ë…€ë„ ì—­ì‹œ ì¢‹ì€ ì‚¬ì§„ì„ ì°ê³  ì‹¶ì—ˆë‹¤.", "words": ["wanted", "to", "good", "pictures,", "She", "take", "too"], "answer": "She wanted to take good pictures, too" },
        { "korean": "ê·¸ë…€ëŠ” ì‚¬ì§„ ì°ëŠ” ê²ƒì„ ì •ë§ ì¢‹ì•„í•œë‹¤.", "words": ["really", "pictures", "likes", "to", "She", "take"], "answer": "She really likes to take pictures" },
        { "korean": "ë‚˜ì˜ ê³„íšì€ ìŠ¤í˜ì¸ì–´ë¥¼ ë°°ìš°ëŠ” ê²ƒì´ë‹¤.", "words": ["to", "Spanish", "learn", "My", "is", "plan"], "answer": "My plan is to learn Spanish" },
        { "korean": "ì ì‹¬ ë¨¹ëŠ” ê²ƒì„ ìŠì—ˆë„¤.", "words": ["forgot", "to", "lunch", "I", "have"], "answer": "I forgot to have lunch" },
        { "korean": "ê·¸ëŠ” ê¸´ ë¶“ì„ ì§‘ì–´ ë“¤ê³  ê·¸ë¦¼ì„ ê·¸ë¦¬ê¸° ì‹œì‘í–ˆì–´.", "words": ["He", "and", "started", "paint", "a", "long", "brush", "picked", "up", "to"], "answer": "He picked up a long brush and started to paint" },
        { "korean": "ë‚˜ëŠ” ê·¸ì™€ ê°™ì€ í™”ê°€ê°€ ë˜ê³  ì‹¶ì–´.", "words": ["want", "to", "be", "painter", "I", "a", "like", "him"], "answer": "I want to be a painter like him" },
        { "korean": "ë¯¸ì†Œë¥¼ ì§“ëŠ” ê²ƒì„ ìŠì§€ ë§ˆì„¸ìš”!", "words": ["forget", "smile", "to", "Don't"], "answer": "Don't forget to smile" },
        { "korean": "ë‚´ ì†Œì›ì€ ì–¸ë•ì— ìˆëŠ” ì§‘ì—ì„œ ì‚¬ëŠ” ê²ƒì´ì•¼.", "words": ["is", "a", "My", "to", "house", "live", "in", "the", "hill", "on"], "answer": "My wish is to live in a house on the hill" },
        { "korean": "ë‚˜ëŠ” ë§¤ì¼ 3ê°œì˜ í‘œí˜„ì„ ì™¸ìš°ë ¤ê³  ë…¸ë ¥í•œë‹¤.", "words": ["I", "memorize", "try", "three", "expressions", "to"], "answer": "I try to memorize three expressions" },
        { "korean": "ë‚˜ëŠ” ì˜ì–´ë¥¼ ì˜í•˜ê³  ì‹¶ì–´.", "words": ["want", "to", "English", "be", "I", "at", "good"], "answer": "I want to be good at English" }
    ];

    let quizSet = [], currentIdx = 0, score = 0, currentWords = [];

    function prepareQuiz() {
        if (!document.getElementById('name').value) return alert("ì´ë¦„ì„ ì…ë ¥í•˜ì„¸ìš”.");
        quizSet = [...allData].sort(() => Math.random() - 0.5).slice(0, 10);
        document.getElementById('setup-page').classList.add('hidden');
        document.getElementById('quiz-page').classList.remove('hidden');
        loadQuestion();
    }

    function loadQuestion() {
        if (currentIdx >= 10) return finishQuiz();
        const item = quizSet[currentIdx];
        document.getElementById('korean-display').innerText = item.korean;
        document.getElementById('progress-inner').style.width = (currentIdx / 10 * 100) + "%";
        resetSentence();
    }

    function resetSentence() {
        currentWords = [];
        const container = document.getElementById('chips-container');
        const display = document.getElementById('sentence-display');
        container.innerHTML = '';
        display.innerHTML = '';
        
        // ë‹¨ì–´ ë¬´ì‘ìœ„ ì…”í”Œ
        const shuffled = [...quizSet[currentIdx].words].sort(() => Math.random() - 0.5);
        
        shuffled.forEach(w => {
            const chip = document.createElement('div');
            chip.className = 'word-chip';
            chip.innerText = w;
            chip.onclick = () => addWord(chip, w);
            container.appendChild(chip);
        });
    }

    function addWord(chip, word) {
        if (chip.classList.contains('used')) return;
        chip.classList.add('used');
        currentWords.push(word);
        
        const displayChip = document.createElement('div');
        displayChip.className = 'word-chip in-sentence';
        displayChip.innerText = word;
        document.getElementById('sentence-display').appendChild(displayChip);
    }

    function submitAnswer() {
        const userSentence = currentWords.join(" ").replace(/ ,/g, ",").replace(/ \./g, ".");
        const correctSentence = quizSet[currentIdx].answer;
        
        if (userSentence.toLowerCase() === correctSentence.toLowerCase()) {
            score++;
        }
        currentIdx++;
        loadQuestion();
    }

    function finishQuiz() {
        document.getElementById('quiz-page').classList.add('hidden');
        document.getElementById('result-page').classList.remove('hidden');
        document.getElementById('res-score').innerText = score + " / 10";
    }
</script>
</body>
</html>